<div class="container-fluid">
  <div class="row filters-row mx-2 mx-md-4 align-items-center">
    <!-- Search -->
    <div class="col-12 col-md-5 mb-2 mb-md-0">
      <div class="search-wrap">
        <i class="bi bi-search"></i>
        <input class="search-input" type="text" placeholder="Title, location, or description" [ngModel]="search()"
          (ngModelChange)="search.set($event)" />
      </div>
    </div>

    <!-- Destination filter -->
    <div class="col-4 col-md-2 mb-2 mb-md-0">
      <select class="form-select search-wrap" [ngModel]="destination()" (ngModelChange)="destination.set($event)">
        <option value="">Destination</option>
        <option *ngFor="let dest of destinations()" [value]="dest">{{ dest }}</option>
      </select>
    </div>

    <!-- Type filter -->
    <div class="col-4 col-md-2 mb-2 mb-md-0">
      <select class="form-select search-wrap" [ngModel]="type()" (ngModelChange)="type.set($event)">
        <option value="">Type</option>
        <option *ngFor="let listingType of types()" [value]="listingType">{{ listingType }}</option>
      </select>
    </div>

    <!-- Max Price -->
    <div class="col-4 col-md-2 mb-2 mb-md-0">
      <input type="number" placeholder="Max Price" class="form-control search-wrap" [ngModel]="maxPrice()"
        (ngModelChange)="maxPrice.set($event === '' ? null : +$event)" />
    </div>

    <!-- Reset btn - Now positioned at the end -->
    <div class="col-12 col-md-1 mb-2 mb-md-0">
      <div class="d-flex justify-content-end">
        <button class="btn reset-btn glass-btn rounded-4 w-md-auto" (click)="resetFilters()">
          <i class="bi bi-arrow-clockwise"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- MAIN ROW -->
  <div class="row mx-2 mx-md-4">
    <!-- Listings -->
    <div class="col-12 col-lg-10 listings-row mb-3 mb-lg-0">
      <div class="cards-list">
        <app-listing-card *ngFor="let listing of filtered(); trackBy: trackById" [listing]="listing">
        </app-listing-card>
      </div>

      <div *ngIf="loading()" class="text-center my-3">
        Loading listings...
      </div>

      <div *ngIf="error()" class="alert alert-danger my-3">
        {{ error() }}
      </div>
    </div>

    <!-- SIDEBAR -->
    <div class="col-12 col-lg-2">
      <div class="listings-row glass-card p-3">
        <!-- Amenities -->
        <div class="section mb-2">
          <h5 class="text-white mb-3">Amenities</h5>
          <div class="amenities-grid">
            <button *ngFor="let amenity of amenitiesList" type="button" class="amenity-btn"
              [class.selected]="isAmenitySelected(amenity)" (click)="toggleAmenity(amenity)">
              {{ amenity }}
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>